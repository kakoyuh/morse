<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="google-adsense-account" content="ca-pub-6741848109234929">
<title>Morse Beat</title>

<!-- ===== Google AdSense (publisher id å·²å¡«) - è‡ªå‹•å»£å‘Š + æ‰‹å‹•ç‰ˆä½ä½”ä½ ===== -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6741848109234929"
     crossorigin="anonymous"></script>
<!-- æ³¨æ„ï¼šç©¿æ’å¼/éŒ¨å®šå¼éœ€åœ¨ AdSense å¾Œå°å•Ÿç”¨ï¼ˆä½ å‰›æ‰çš„è¨­å®šç•«é¢ï¼‰ -->

<style>
  @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap");

  * { box-sizing: border-box; font-family: "Poppins", sans-serif; margin: 0; padding: 0; }
  body {
    background: radial-gradient(circle at top, #1a1a1a, #0e0e0e);
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    color: #fff;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 40px 20px;
    overflow-x: hidden;
  }

  .container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 25px;
    width: 100%;
    max-width: 1000px;
    z-index: 2;
    position: relative;
  }

  .card {
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: 20px;
    backdrop-filter: blur(15px);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.35);
    padding: 25px;
    width: 320px;
    text-align: center;
    transition: all 0.3s ease;
    z-index: 2;
  }
  .card:hover { transform: translateY(-5px); }

  h1, h2 {
    font-weight: 600;
    margin-bottom: 15px;
    background: linear-gradient(90deg, #00ccff, #00ffaa);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  input, textarea {
    width: 100%;
    padding: 12px;
    border-radius: 10px;
    border: none;
    outline: none;
    font-size: 15px;
    resize: none;
    text-align: center;
    background: rgba(255,255,255,0.08);
    color: #fff;
    margin-bottom: 15px;
  }

  .output {
    background: rgba(0,0,0,0.4);
    border-radius: 10px;
    padding: 15px;
    min-height: 50px;
    color: #aef;
    font-size: 16px;
    margin-bottom: 15px;
    word-break: break-word;
  }

  button {
    background: linear-gradient(135deg, #00aaff, #00ffaa);
    border: none;
    border-radius: 10px;
    padding: 10px 16px;
    color: #000;
    font-weight: 600;
    margin: 5px;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  button:hover { background: linear-gradient(135deg, #00ccff, #00ffcc); transform: scale(1.05); }

  .copy-btn { background: linear-gradient(135deg, #34C759, #4cd964); }
  .copy-btn:hover { background: linear-gradient(135deg, #28a745, #34c759); }
  .share-btn { background: linear-gradient(135deg, #ff9500, #ffaa33); }
  .share-btn:hover { background: linear-gradient(135deg, #cc7a00, #ff9500); }

  .flash { animation: flash 0.2s ease; }
  @keyframes flash { 0% { background-color: #00ffaa33; } 100% { background-color: transparent; } }

  .toast {
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%) translateY(30px);
    background: rgba(255,255,255,0.15);
    border: 1px solid rgba(255,255,255,0.1);
    backdrop-filter: blur(15px);
    color: #fff;
    padding: 12px 25px;
    border-radius: 25px;
    opacity: 0;
    transition: all 0.4s ease;
    font-size: 15px;
    z-index: 999;
  }
  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

  .upload-card img { width: 100%; margin-top: 10px; border-radius: 12px; display: none; }

  /* ===== æ‰‹å‹•å»£å‘Šä½æ¨£å¼ï¼ˆä½”ä½ï¼‰ ===== */
  .ad {
    position: fixed;
    z-index: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px;
    background: rgba(255,255,255,0.04);
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.06);
    backdrop-filter: blur(10px);
  }

  /* å´æ¬„å»£å‘Šï¼ˆæ¡Œæ©Ÿï¼‰ */
  .ad-left, .ad-right {
    width: 120px;
    height: 300px;
    top: 50%;
    transform: translateY(-50%);
  }
  .ad-left { left: 10px; }
  .ad-right { right: 10px; }

  /* é ‚éƒ¨ / åº•éƒ¨ éŒ¨å®šå»£å‘Š (anchor) */
  .ad-top, .ad-bottom {
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    max-width: 980px;
    margin: 0 auto;
    height: auto;
    padding: 6px;
  }
  .ad-top { top: 8px; position: fixed; }
  .ad-bottom { bottom: 8px; position: fixed; }

  /* æ‰‹æ©Ÿä»‹é¢èª¿æ•´ï¼šéš±è—å´æ¬„ï¼Œtop/bottom ç¸®çª„ */
  @media (max-width: 767px) {
    .ad-left, .ad-right { display: none; }
    .ad-top, .ad-bottom { max-width: 360px; width: 94%; }
    .card { width: 90%; }
    .upload-card { order: -1; margin-bottom: 20px; width: 90%; }
  }

  /* Footer */
  footer {
    width: 100%;
    text-align: center;
    padding: 15px 0;
    color: #fff;
    position: fixed;
    bottom: 0;
    left: 0;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(10px);
    font-size: 14px;
    z-index: 2;
  }

  /* ç¥ç§˜åˆ†äº«ç•«é¢æ¨£å¼ */
  .surprise-screen {
    position: fixed;
    inset: 0;
    display:flex;
    align-items:center;
    justify-content:center;
    background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.8));
    z-index: 1000;
    color: #fff;
    padding: 30px;
  }
  .surprise-inner {
    width: min(640px, 92%);
    background: rgba(255,255,255,0.04);
    border-radius: 14px;
    padding: 24px;
    text-align: center;
    backdrop-filter: blur(8px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.6);
  }
  .surprise-inner button { margin-top: 16px; }
</style>
</head>
<body>

  <!-- ===== æ‰‹å‹•ç‰ˆä½ï¼šä¸Šæ–¹éŒ¨å®š (è«‹åœ¨ AdSense å»ºç«‹å»£å‘Šå–®å…ƒå¾Œæ›¿æ› data-ad-slot) ===== -->
  <div class="ad ad-top" aria-hidden="true">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-6741848109234929"
         data-ad-slot="REPLACE_TOP_SLOT"   <!-- <-- æŠŠ REPLACE_TOP_SLOT æ›æˆä½ ä¸Šæ–¹å»£å‘Šçš„ ad-slot -->
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
  </div>

  <!-- ===== æ‰‹å‹•ç‰ˆä½ï¼šå·¦å´ï¼ˆæ¡Œæ©Ÿï¼‰ ===== -->
  <div class="ad ad-left" aria-hidden="true">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-6741848109234929"
         data-ad-slot="REPLACE_LEFT_SLOT"  <!-- <-- æŠŠ REPLACE_LEFT_SLOT æ›æˆä½ å·¦å´å»£å‘Šçš„ ad-slot -->
         data-ad-format="auto"></ins>
  </div>

  <!-- ===== æ‰‹å‹•ç‰ˆä½ï¼šå³å´ï¼ˆæ¡Œæ©Ÿï¼‰ ===== -->
  <div class="ad ad-right" aria-hidden="true">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-6741848109234929"
         data-ad-slot="REPLACE_RIGHT_SLOT"  <!-- <-- æŠŠ REPLACE_RIGHT_SLOT æ›æˆä½ å³å´å»£å‘Šçš„ ad-slot -->
         data-ad-format="auto"></ins>
  </div>

  <!-- ===== æ‰‹å‹•ç‰ˆä½ï¼šä¸‹æ–¹éŒ¨å®š (è«‹åœ¨ AdSense å»ºç«‹å»£å‘Šå–®å…ƒå¾Œæ›¿æ› data-ad-slot) ===== -->
  <div class="ad ad-bottom" aria-hidden="true">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-6741848109234929"
         data-ad-slot="REPLACE_BOTTOM_SLOT"  <!-- <-- æŠŠ REPLACE_BOTTOM_SLOT æ›æˆä½ ä¸‹æ–¹å»£å‘Šçš„ ad-slot -->
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
  </div>

  <!-- ===== ä¸»è¦å…§å®¹å®¹å™¨ ===== -->
  <div class="container">

    <!-- ç·¨ç¢¼å€ -->
    <div class="card">
      <h1>ğŸµ Morse Beat</h1>
      <input type="text" id="textInput" placeholder="è¼¸å…¥æ–‡å­—..." />
      <div class="output" id="morseOutput">ç­‰å¾…è¼¸å…¥...</div>
      <div>
        <button id="convertBtn">è½‰æ›</button>
        <button id="playBtn">æ’­æ”¾ç¯€å¥</button>
        <button id="stopBtn">åœæ­¢</button>
        <button class="copy-btn" onclick="copyText('morseOutput')">è¤‡è£½æ‘©æ–¯ç¢¼</button>
        <button class="share-btn" id="shareBtn">åˆ†äº«æ‘©æ–¯ç¢¼</button>
      </div>
    </div>

    <!-- è§£ç¢¼å€ -->
    <div class="card">
      <h2>ğŸ” è§£ç¢¼å€</h2>
      <textarea id="decodeInput" rows="4" placeholder="è¼¸å…¥æ‘©æ–¯ç¢¼ï¼ˆä¾‹å¦‚ï¼š.... . .-.. .-.. ---ï¼‰"></textarea>
      <div class="output" id="decodeOutput">ç­‰å¾…è§£ç¢¼...</div>
      <div>
        <button id="decodeBtn">è§£ç¢¼</button>
        <button class="copy-btn" onclick="copyText('decodeOutput')">è¤‡è£½è§£ç¢¼æ–‡å­—</button>
        <button class="share-btn" onclick="shareText('decodeOutput')">åˆ†äº«æ–‡å­—</button>
      </div>
    </div>

    <!-- ä¸Šå‚³èƒŒæ™¯å€ï¼ˆæœ€å¾Œä¸€å€‹ï¼‰ -->
    <div class="card upload-card">
      <h2>ğŸ–¼ ä¸Šå‚³èƒŒæ™¯</h2>
      <input type="file" id="bgInput" accept="image/*" />
      <img id="preview" alt="èƒŒæ™¯é è¦½">
    </div>

  </div>

  <div id="toast" class="toast">âœ… å·²è¤‡è£½ï¼</div>
  <footer>Â© 2025 MorseBeat</footer>

<script>
  // ===== åˆå§‹åŒ–æ‰‹å‹•å»£å‘Šï¼ˆpushï¼‰ =====
  // é€™æœƒå‘Šè¨´ AdSense åœ¨é é¢ä¸Šçš„ <ins> å€å¡Šè¼‰å…¥å»£å‘Š
  (adsbygoogle = window.adsbygoogle || []).push({});

  // ===== æ‘©æ–¯ç¢¼é‚è¼¯ =====
  const textInput = document.getElementById("textInput");
  const morseOutput = document.getElementById("morseOutput");
  const convertBtn = document.getElementById("convertBtn");
  const playBtn = document.getElementById("playBtn");
  const stopBtn = document.getElementById("stopBtn");

  const decodeInput = document.getElementById("decodeInput");
  const decodeOutput = document.getElementById("decodeOutput");
  const decodeBtn = document.getElementById("decodeBtn");

  const MORSE = {
    A: ".-", B: "-...", C: "-.-.", D: "-..", E: ".", F: "..-.", G: "--.", H: "....",
    I: "..", J: ".---", K: "-.-", L: ".-..", M: "--", N: "-.", O: "---",
    P: ".--.", Q: "--.-", R: ".-.", S: "...", T: "-", U: "..-", V: "...-", W: ".--",
    X: "-..-", Y: "-.--", Z: "--..",
    "1": ".----", "2": "..---", "3": "...--", "4": "....-", "5": ".....",
    "6": "-....", "7": "--...", "8": "---..", "9": "----.", "0": "-----", " ": "/"
  };
  const REVERSE = Object.fromEntries(Object.entries(MORSE).map(([k,v]) => [v,k]));

  let audioCtx, playing=false;
  function textToMorse(t){return t.toUpperCase().split("").map(c=>MORSE[c]||"").join(" "); }
  function morseToText(m){return m.split(" / ").map(w=>w.split(" ").map(s=>REVERSE[s]||"").join("")).join(" ");}

  convertBtn.onclick = ()=>{ morseOutput.textContent = textToMorse(textInput.value.trim()) || "ï¼ˆç„¡æ•ˆè¼¸å…¥ï¼‰"; };
  decodeBtn.onclick = ()=>{ decodeOutput.textContent = morseToText(decodeInput.value.trim()) || "ï¼ˆç„¡æ•ˆæ‘©æ–¯ç¢¼ï¼‰"; };

  function playMorse(m){
    if(!m||playing)return;
    playing=true;
    audioCtx=new(window.AudioContext||window.webkitAudioContext)();
    const unit=0.15; let time=audioCtx.currentTime;
    m.split("").forEach(s=>{
      if(s==="."){beep(time,unit);flash();time+=unit*2;}
      else if(s==="-"){beep(time,unit*3);flash();time+=unit*4;}
      else if(s===" ")time+=unit*2;
      else if(s==="/")time+=unit*6;
    });
    setTimeout(()=>playing=false,(time-audioCtx.currentTime)*1000);
  }
  function beep(start,d){
    const o=audioCtx.createOscillator(),g=audioCtx.createGain();
    o.type="sine"; o.frequency.setValueAtTime(600,audioCtx.currentTime);
    o.connect(g); g.connect(audioCtx.destination);
    o.start(start); o.stop(start+d);
  }
  function flash(){
    morseOutput.classList.add("flash");
    setTimeout(()=>morseOutput.classList.remove("flash"),100);
  }
  playBtn.onclick=()=>{const m=morseOutput.textContent.trim(); if(m&&m!=="ç­‰å¾…è¼¸å…¥...") playMorse(m);};
  stopBtn.onclick=()=>{if(audioCtx)audioCtx.close(); playing=false;};

  // ===== è¤‡è£½èˆ‡åˆ†äº« =====
  function copyText(id){
    const t=document.getElementById(id).textContent.trim();
    if(!t||t.startsWith("ç­‰å¾…"))return;
    navigator.clipboard.writeText(t);
    showToast("âœ… å·²è¤‡è£½ï¼");
  }
  function shareText(id){
    const t=document.getElementById(id).textContent.trim();
    if(!t||t.startsWith("ç­‰å¾…"))return;
    const url=location.origin+location.pathname+"?share="+encodeURIComponent(t);
    if(navigator.share) navigator.share({title:"Morse Beat",text:t,url});
    else { prompt("è¤‡è£½åˆ†äº«é€£çµï¼š",url); showToast("ğŸ”— åˆ†äº«é€£çµå·²è¤‡è£½ï¼"); }
  }
  function showToast(msg){
    const toast=document.getElementById("toast");
    toast.textContent=msg; toast.classList.add("show");
    setTimeout(()=>toast.classList.remove("show"),1500);
  }

  // åˆ†äº«æŒ‰éˆ•ï¼šè¤‡è£½é€£çµï¼ˆä¸¦å¼•å°ä½¿ç”¨è€…ï¼‰
  document.getElementById("shareBtn").addEventListener("click", ()=>{
    const m = morseOutput.textContent.trim();
    if(!m || m==="ç­‰å¾…è¼¸å…¥...") { showToast("âš ï¸ å…ˆè½‰æ›ä¸€æ®µæ–‡å­—å†åˆ†äº«"); return; }
    const url = location.origin + location.pathname + "?share=" + encodeURIComponent(m);
    // ç”¨ Web Share API æˆ– fallback
    if(navigator.share) {
      navigator.share({ title: "Morse Beat", text: "çµ¦ä½ ä¸€æ®µæ‘©æ–¯é©šå–œï¼", url })
        .catch(()=>{ prompt("åˆ†äº«é€£çµï¼š", url); });
    } else {
      prompt("åˆ†äº«é€£çµï¼ˆè¤‡è£½ï¼‰ï¼š", url);
    }
  });

  // ===== èƒŒæ™¯ä¸Šå‚³ =====
  document.getElementById("bgInput").addEventListener("change", e=>{
    const file=e.target.files[0]; if(!file) return;
    const reader=new FileReader();
    reader.onload = ev => {
      document.body.style.backgroundImage = `url(${ev.target.result})`;
      const img = document.getElementById("preview");
      img.src = ev.target.result;
      img.style.display = "block";
    };
    reader.readAsDataURL(file);
  });

  // ===== URL åˆ†äº«é©šå–œæ¨¡å¼ï¼ˆéœ€è¦æŒ‰ã€Œè§£ç¢¼ã€æ‰é¡¯ç¤ºï¼‰ =====
  (function handleShareSurprise(){
    const params = new URLSearchParams(window.location.search);
    if (!params.has("share")) return;
    const shared = params.get("share");

    // éš±è—ä¸»è¦å…§å®¹ã€é¡¯ç¤ºé©šå–œç•«é¢
    document.querySelector(".container").style.filter = "blur(2px)";
    const surprise = document.createElement("div");
    surprise.className = "surprise-screen";
    surprise.innerHTML = `
      <div class="surprise-inner">
        <h2>ğŸ”’ ä½ æ”¶åˆ°ä¸€æ®µæ‘©æ–¯å¯†ç¢¼ï¼</h2>
        <p style="margin-top:8px;">æŒ‰ä¸‹ã€Œè§£ç¢¼ã€æ­æ›‰é©šå–œã€‚<br>ï¼ˆæŒ‰ä¸‹å¾Œæœƒé¡¯ç¤ºè§£ç¢¼çµæœï¼‰</p>
        <div style="display:flex; gap:10px; justify-content:center; margin-top:18px;">
          <button id="revealBtn">ğŸ”“ è§£ç¢¼</button>
          <button id="closeBtn" style="background:rgba(255,255,255,0.06); color:#fff;">å–æ¶ˆ</button>
        </div>
      </div>
    `;
    document.body.appendChild(surprise);

    // è§£ç¢¼æŒ‰éˆ•
    document.getElementById("revealBtn").onclick = () => {
      // é¡¯ç¤ºçµæœåœ¨ä¸€å€‹å¡ç‰‡å…§ï¼ˆé¿å…è‡ªå‹•è·³åˆ° decode å€ï¼‰
      const result = morseToText(shared) || "ï¼ˆç„¡æ•ˆæ‘©æ–¯ç¢¼ï¼‰";
      surprise.querySelector(".surprise-inner").innerHTML = `
        <h2>ğŸ è§£ç¢¼çµæœ</h2>
        <div style="margin-top:12px; padding:14px; background:rgba(255,255,255,0.06); border-radius:10px;">
          <strong style="font-size:18px;">${escapeHtml(result)}</strong>
        </div>
        <div style="margin-top:18px;">
          <button id="toSiteBtn">å›åˆ°ç¶²ç«™</button>
        </div>
      `;
      document.getElementById("toSiteBtn").onclick = ()=> {
        // ç§»é™¤ query åƒæ•¸ä¸¦é¡¯ç¤º decode çµæœåœ¨ decode å€ï¼ˆå¯é¸ï¼‰
        history.replaceState(null, "", location.pathname);
        surprise.remove();
        document.querySelector(".container").style.filter = "none";
        decodeInput.value = shared;
        decodeOutput.textContent = morseToText(shared) || "ï¼ˆç„¡æ•ˆæ‘©æ–¯ç¢¼ï¼‰";
      };
    };

    // å–æ¶ˆæŒ‰éˆ•
    document.getElementById("closeBtn").onclick = () => {
      surprise.remove();
      document.querySelector(".container").style.filter = "none";
      // æ¸…é™¤ query (é¿å…é‡æ–°è¼‰å…¥æ™‚ä»ç„¶å‡ºç¾)
      history.replaceState(null, "", location.pathname);
    };
  })();

  // ===== å·¥å…·å‡½å¼ =====
  function escapeHtml(text) {
    return text.replace(/[&<>"']/g, function(m){ return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]; });
  }

  // ===== å¦‚æœæƒ³è®“æ‰‹å‹•å»£å‘Šåœ¨å‹•æ…‹è¼‰å…¥å¾Œå†æ¬¡ push (ä¾‹å¦‚ SPA) =====
  // window.onload å·²ç¶“åšäº†ä¸€æ¬¡ pushï¼›è‹¥ä½ æœ‰å‹•æ…‹æ–°å¢ <ins>ï¼Œå¯ä»¥å†æ¬¡å‘¼å« (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</body>
</html>
